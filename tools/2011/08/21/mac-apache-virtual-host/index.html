<!DOCTYPE html><html><head><meta charset=utf-8><title>MacのApacheでヴァーチャルホストを使ってテスト環境の構築</title><meta name=viewport content="width=device-width"><meta name=description content=""><!-- Twitter --><meta name=twitter:card content=summary><meta name=twitter:author content=@howtohp><meta name=twitter:title content=MacのApacheでヴァーチャルホストを使ってテスト環境の構築><meta name=twitter:description content=""><!-- Facebook --><meta property=og:type content=article><meta property=og:title content=MacのApacheでヴァーチャルホストを使ってテスト環境の構築><meta property=og:description content=""><meta property=og:url content="http:howtohp.com/tools/2011/08/21/mac-apache-virtual-host/"><meta property=og:locale content=ja-JP><meta property=article:published_time content="2011-08-21 00:00:00 +0900"><link rel=stylesheet href=/css/main.2309.css><link rel=stylesheet href=/css/main.2309.css></head><body><header class="header container" role=banner><div class=header__title><h1><a href="/">howtohp</a></h1></div><nav class=global-nav role=navigation><ul class=global-nav__list><li class=global-nav__item><a class=global-nav__link href="/">HOME</a></li><li class=global-nav__item><a class=global-nav__link href=/archive>Archive</a></li><li class=global-nav__item><a class=global-nav__link href=/about>About</a></li></ul></nav></header><div class="main container--small" role=main><article class="entry h-entry" itemscope itemtype=http://schema.org/BlogPosting><header class=entry__header><h1 class=entry__title itemprop=name>MacのApacheでヴァーチャルホストを使ってテスト環境の構築</h1><div class=entry__meta><time class=entry__published itemprop=datePublished datetime="21 Aug 2011"><span class=icon-calendar></span> 21 Aug, 2011</time><div class=entry__tags><span class=icon-tags></span><ul class=entry__tags__list><li class=entry__tags__item itemprop=keywords>Apache</li><li class=entry__tags__item itemprop=keywords>Mac</li></ul></div></div><!-- / .entry__meta --></header><div class=entry__content itemprop=articleBody><p>Macには元々Apacheが入ってるので、それの使い方と、自分の使い方の紹介。(<span class=caps>MAMP</span>は使いません。)<br>Windowsでの設定は<a href="/tools/2009/10/05/dreamweaver-apache/">DreamweaverとApacheを連携して、テスト環境の構築</a>の記事が参考になるかもしれません。</p><section id=workspace><h1 id=section>ワークスペースの作成</h1><p>とりあえず、作業用のディレクトリはサーバー使うにしろ使わないにしろ一箇所にまとめておきたいので、&nbsp;<code>/Users/ユーザー名/work</code>の様に今後ここに色んなサイト用のディレクトリを掘っていく作業場所をつくっておきます。</p></section><section id=apache><h1 id=section-1>サーバー側の設定</h1><h2 id=section-2>ヴァーチャルホスト設定</h2><p>Apacheの設定ファイルは、<code>/etc/apache2/httpd.conf</code>に書かれています。</p><p>設定ファイルはroot権限がないと編集できないので、ターミナルで、<code>sudo</code>をつけてvimで編集します。</p><div class=highlight><pre><code class=bash>sudo vim /etc/apache2/httpd.conf <span class=c>#vimでapacheの設定ファイルを開く</span>

<span class=c># Virtual hosts</span>
Include /private/etc/apache2/extra/httpd-vhosts.conf <span class=c>#ヴァーチャルホスト用の設定ファイルを読みこむため、行頭の#を削除</span></code></pre></div><p>これで、バーチャルホストの設定ファイルが読み込まれるはずです。</p><h2 id=section-3>読み込んだバーチャルホストの設定ファイルの中身を編集</h2><p>次に先ほどよみこんだ、バーチャルホストの設定ファイルを編集します。</p><div class=highlight><pre><code class=bash>&lt;virtualhost *:80&gt;
DocumentRoot <span class=s2>&quot;/Library/WebServer/Documents/local.howtohp.com&quot;</span>
ServerName local.howtohp.com
ErrorLog <span class=s2>&quot;/private/var/log/apache2/local.howtohp.com-error_log&quot;</span>
CustomLog <span class=s2>&quot;/private/var/log/apache2/local.howtohp.com-access_log&quot;</span> common
&lt;/virtualhost&gt;</code></pre></div><p>こんな感じが最小の設定になるかと思います。ServerNameはネット上に存在しないアドレスにするよう注意してください。<br>今後同じ<span class=caps>URL</span>のサイトを見れなくなってしまいます。</p><p>今回のサンプルでは、<code>/Library/WebServer/Documents/local.howtohp.com</code>がドキュメントルートになります。</p><h2 id=hosts>hostsファイルの設定</h2><p>Macのホストファイルは<code>/etc/hosts</code>にありますので、これも<code>sudo</code>で編集し、先ほどバーチャルホストの設定ファイルにかいた、サーバーネームを追記します。</p><div class=highlight><pre><code>127.0.0.1 local.howtohp.com
</code></pre></div><p>これで、http://local.howtohp.comへアクセスしたときにローカルサーバー内の/Library/WebServer/Documents/local.howtohp.comを見に行くようになります。</p><h2 id=apache>Apacheの再起動</h2><p>Apacheの設定を変更したら、再起動するまで読み込まれないので、以下のコマンドで再起動します。<br>ここでもroot権限が必要です。</p><div class=highlight><pre><code class=bash>apachectl -t <span class=c>#これで設定ファイルがうまくいってるか一応チェック</span>
Syntax OK <span class=c>#これがでたら問題無し。</span>

sudo apachectl restart　#Apacheの再起動</code></pre></div><h2 id=section-4>ローカルサーバーのディレクトリをワークスペースへシンボリックリンクを貼る。</h2><p>次に作業用のディレクトリとサーバー内で、いちいち同期するのとかローカル環境ではめんどくさいので、シンボリックリンクを貼っておきます。</p><div class=highlight><pre><code class=bash>ln -s /Library/WebServer/Documents/local.howtohp.com ~/work/local.howtohp.com</code></pre></div><p>これで、サーバー内のファイルをワークスペース内で直接編集できますね。完了です。</p><p>以前は、rsyncコマンド使っていちいち同期してたんですが、ローカル環境でそんなことやってるのがアホらしくなったので、直接編集することにしました。</p></section></div></article><div class=pager><a href=# class=pager__prev>&lt;&lt; Prev</a> <a href=# class=pager__next>Next &gt;&gt;</a></div><hr><section class=related-posts><h1>関連記事</h1><ul><li><a rel=bookmark href="/tools/2013/04/24/useful-command-line/">Macユーザーなら覚えといた方がいいTerminalの便利なコマンド</a></li><li><a rel=bookmark href="/tools/2009/10/05/dreamweaver-apache/">DreamweaverとApacheを連携して、テスト環境の構築</a></li><li><a rel=bookmark href="/css/2011/09/19/compass/">CSS書くならCompass使った方がいいよ。SASS使ってる人なら特に。</a></li><li><a rel=bookmark href="/tools/2011/08/16/homebrew-install/">Macにパッケージ管理ソフトのhomebrewをインストール</a></li><li><a rel=bookmark href="/other/2012/04/13/wordpress-development-ready/">リニューアルしてたらなんとなくWordpressの作業の流れが固まってきた。(下準備編)</a></li></ul></section></div><!-- / .main --><div class="footer-container container"><footer class=footer role=contentinfo><div class=social-rss><ul class=social-rss__list><li class=social-rss__item><a href=http://twitter.com/#!/howtohp id=twitter title=Twitter>Twitter</a></li><li class=social-rss__item><a href=http://www.facebook.com/howtohp id=facebook-page title="Facebook Page">Facebook Page</a></li><li class=social-rss__item><a href=http://feeds.feedburner.com/howtohp/ZiSA id=feed title=Feed>feed</a></li></ul></div><p><small class=copy>&#9786;&nbsp;howtohp</small> Powered by <a href="http://jekyllrb.com/">Jekyll</a></p></footer></div><!-- / #footer-container --><script src=/js/scripts.d5d1.js></script></body></html>