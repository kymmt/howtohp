<!DOCTYPE html><html><head><meta charset=utf-8><title>jQueryで外部リンクを新規ウィンドウで開きアイコンを付ける。</title><meta name=viewport content="width=device-width"><meta name=description content=""><!-- Twitter --><meta name=twitter:card content=summary><meta name=twitter:author content=@howtohp><meta name=twitter:title content=jQueryで外部リンクを新規ウィンドウで開きアイコンを付ける。><meta name=twitter:description content=""><!-- Facebook --><meta property=og:type content=article><meta property=og:title content=jQueryで外部リンクを新規ウィンドウで開きアイコンを付ける。><meta property=og:description content=""><meta property=og:url content="http:howtohp.com/javascript/2008/10/19/external/"><meta property=og:locale content=ja-JP><meta property=article:published_time content="2008-10-19 00:00:00 +0900"><link rel=stylesheet href=/css/main.50c7.css><link rel=stylesheet href=/css/main.50c7.css></head><body><header class="header container" role=banner><div class=header__title><h1><a href="/">howtohp</a></h1></div><nav class=global-nav role=navigation><ul class=global-nav__list><li class=global-nav__item><a class=global-nav__link href="/">HOME</a></li><li class=global-nav__item><a class=global-nav__link href=/archive>Archive</a></li><li class=global-nav__item><a class=global-nav__link href=/about>About</a></li></ul></nav></header><div class="main container--small" role=main><article class="entry h-entry" itemscope itemtype=http://schema.org/BlogPosting><header class=entry__header><h1 class=entry__title itemprop=name>jQueryで外部リンクを新規ウィンドウで開きアイコンを付ける。</h1><div class=entry__meta><time class=entry__published itemprop=datePublished datetime="19 Oct 2008"><span class=icon-calendar></span> 19 Oct, 2008</time><div class=entry__tags><span class=icon-tags></span><ul class=entry__tags__list><li class=entry__tags__item itemprop=keywords>JQuery</li></ul></div></div><!-- / .entry__meta --></header><div class=entry__content itemprop=articleBody><p>以前にも書いたエントリーなんですが、消しちゃったので、リライトです。</p><p>外部リンクを新規ウィンドウで開くっていうのを実現しようとすると、aタグのtarget属性に&quot;_blank&quot;を指定するんですが、DOCTYPE宣言がstrictの場合、target属性が非推奨で使えないので、Javascriptで実現するしかないわけです。</p><p><!--more--></p><p>なので、httpもしくは、httpsで始まるものを新規ウィンドウで開くようにし、ついでに、外部リンクの場合、ユーザビリティの向上のために、外部リンクであるとわかりやすいようにアイコンも付けれるように会社の人にjQueryを使って書いてもらいました。</p><p>以下がソースです。</p><div class=highlight><pre><code class=javascript><span class=nx>$</span><span class=p>(</span><span class=kd>function</span><span class=p>(){</span>
    <span class=kd>var</span> <span class=nx>domains</span> <span class=o>=</span> <span class=p>[</span><span class=nb>document</span><span class=p>.</span><span class=nx>domain</span><span class=p>,</span><span class=s1>&#39;www.hoge.co.jp&#39;</span><span class=p>,</span><span class=s1>&#39;hoge.co.jp&#39;</span><span class=p>];</span>
    <span class=kd>var</span> <span class=nx>domain_selector</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span><span class=p>,</span><span class=nx>left_str</span><span class=o>=</span> <span class=s2>&quot;:not([href^=http://&quot;</span><span class=p>,</span><span class=nx>left_str_https</span><span class=o>=</span><span class=s2>&quot;:not([href^=https://&quot;</span><span class=p>,</span><span class=nx>right_str</span> <span class=o>=</span> <span class=s2>&quot;])&quot;</span><span class=p>;</span>
    <span class=nx>domain_selector</span> <span class=o>=</span> <span class=nx>left_str</span><span class=o>+</span><span class=nx>domains</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=nx>right_str</span><span class=o>+</span><span class=nx>left_str</span><span class=p>)</span><span class=o>+</span><span class=nx>right_str</span><span class=p>;</span>
    <span class=nx>domain_selector</span><span class=o>+=</span> <span class=nx>left_str_https</span><span class=o>+</span><span class=nx>domains</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=nx>right_str</span><span class=o>+</span><span class=nx>left_str_https</span><span class=p>)</span><span class=o>+</span><span class=nx>right_str</span><span class=p>;</span>

    <span class=nx>$</span><span class=p>(</span><span class=s2>&quot;a[href^=http]&quot;</span><span class=o>+</span><span class=nx>domain_selector</span><span class=o>+</span><span class=s2>&quot;:not(:has(img))&quot;</span><span class=p>).</span><span class=nx>addClass</span><span class=p>(</span><span class=s2>&quot;exlink&quot;</span><span class=p>);</span>
    <span class=nx>$</span><span class=p>(</span><span class=s2>&quot;a[href^=http]&quot;</span><span class=o>+</span><span class=nx>domain_selector</span><span class=p>).</span><span class=nx>click</span><span class=p>(</span><span class=kd>function</span><span class=p>(){</span>
        <span class=nb>window</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>href</span><span class=p>,</span><span class=s2>&quot;_blank&quot;</span><span class=p>);</span>
            <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
        <span class=p>});</span>
    <span class=p>});</span>
<span class=p>});</span>
</code></pre></div><p>ここで、httpもしくはhttpsからはじまるsrc属性を持っているaタグににexlinkというクラスをつけているので、そのクラスにCSSで外部リンク用のアイコンを指定すれば、外部リンクすべてに、アイコンを付けることができます。<br>ちなみに、以前書いていた記事では、aタグの中身が画像でもクラスをつけちゃってたんですが、今回はaタグの中身が画像の場合は除外するようにしています。</p><p>で、関連サイトなんかは外部リンクでURLで指定していても、新規ウィンドウで開いて欲しくない場合もあるかもしれないので、'www.hoge.com'の部分にドメインを指定します。<br>一応、wwwあり、なし両方指定してます。<br>ここで指定したドメインは新規ウィンドウでは開かないようになってます。</p><p>CSSでアイコンを付けるのは以下のような感じでいいかと思います。</p><div class=highlight><pre><code class=css><span class=nt>a</span><span class=nc>.exlink</span> <span class=p>{</span>
    <span class=k>background-image</span><span class=o>:</span><span class=sx>url(アイコン画像へのパス)</span><span class=p>;</span>
    <span class=k>padding-right</span><span class=o>:</span><span class=m>15px</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div><p>CSSで指定している右側のpaddingはアイコン画像の大きさ分＋余白と考えてください。</p></div></article><div class=pager><a href=# class=pager__prev>&lt;&lt; Prev</a> <a href=# class=pager__next>Next &gt;&gt;</a></div><hr><section class=related-posts><h1>関連記事</h1><ul><li><a rel=bookmark href="/tools/2013/04/24/useful-command-line/">Macユーザーなら覚えといた方がいいTerminalの便利なコマンド</a></li><li><a rel=bookmark href="/css/tools/2012/09/22/compass-control-prefix/">Compassでベンダープレフィックスなどのブラウザーサポートを制御する方法</a></li><li><a rel=bookmark href="/css/2013/04/18/prevent_skype/">Skypeのブラウザ拡張を入れてる人が番号をスタイリングしちゃうのを防ぐ方法</a></li><li><a rel=bookmark href="/2013/12/27/sass-bem/">SASSを使ってBEMで記述</a></li><li><a rel=bookmark href="/2008/11/22/min-height/">CSSで最低の高さを実現する。</a></li></ul></section></div><!-- / .main --><div class="footer-container container"><footer class=footer role=contentinfo><div class=social-rss><ul class=social-rss__list><li class=social-rss__item><a href=http://twitter.com/#!/howtohp id=twitter title=Twitter>Twitter</a></li><li class=social-rss__item><a href=http://www.facebook.com/howtohp id=facebook-page title="Facebook Page">Facebook Page</a></li><li class=social-rss__item><a href=http://feeds.feedburner.com/howtohp/ZiSA id=feed title=Feed>feed</a></li></ul></div><p><small class=copy>&#9786;&nbsp;howtohp</small> Powered by <a href="http://jekyllrb.com/">Jekyll</a></p></footer></div><!-- / #footer-container --><script src=/js/scripts.d5d1.js></script></body></html>