<!DOCTYPE html><html><head><meta charset=utf-8><title>リニューアルしてたらなんとなくWordpressの作業の流れが固まってきた。(下準備編)</title><meta name=viewport content="width=device-width"><meta name=description content=""><!-- Twitter --><meta name=twitter:card content=summary><meta name=twitter:author content=@howtohp><meta name=twitter:title content=リニューアルしてたらなんとなくWordpressの作業の流れが固まってきた。(下準備編)><meta name=twitter:description content=""><!-- Facebook --><meta property=og:type content=article><meta property=og:title content=リニューアルしてたらなんとなくWordpressの作業の流れが固まってきた。(下準備編)><meta property=og:description content=""><meta property=og:url content="http:howtohp.com/other/2012/04/13/wordpress-development-ready/"><meta property=og:locale content=ja-JP><meta property=article:published_time content="2012-04-13 00:00:00 +0900"><link rel=stylesheet href=/css/main.50c7.css><link rel=stylesheet href=/css/main.50c7.css></head><body><header class="header container" role=banner><div class=header__title><h1><a href="/">howtohp</a></h1></div><nav class=global-nav role=navigation><ul class=global-nav__list><li class=global-nav__item><a class=global-nav__link href="/">HOME</a></li><li class=global-nav__item><a class=global-nav__link href=/archive>Archive</a></li><li class=global-nav__item><a class=global-nav__link href=/about>About</a></li></ul></nav></header><div class="main container--small" role=main><article class="entry h-entry" itemscope itemtype=http://schema.org/BlogPosting><header class=entry__header><h1 class=entry__title itemprop=name>リニューアルしてたらなんとなくWordpressの作業の流れが固まってきた。(下準備編)</h1><div class=entry__meta><time class=entry__published itemprop=datePublished datetime="13 Apr 2012"><span class=icon-calendar></span> 13 Apr, 2012</time><div class=entry__tags><span class=icon-tags></span><ul class=entry__tags__list><li class=entry__tags__item itemprop=keywords>Wordpress</li></ul></div></div><!-- / .entry__meta --></header><div class=entry__content itemprop=articleBody><p>これでデザインを変えたのは4回目になります。<br>このブログは2007年にはじめて5年目になるのに、記事数が30にも満たないという、えげつないペースでの更新頻度ですが、裏側は結構いじってます。</p><p>リニューアルするにあたって、Jykellを使おうかと思ったんですが、サーバー乗り換えなきゃいけないっぽかったので、今回もWordpressでいきました。</p><p>今回の作業で、自分のやり方が固まってきたので、こんな感じで作業してますってのを書いてみます。<br>もっとこうすればいいのにってのがあれば、突っ込んでもらえると助かります。</p><section><h1 id=section>まずは下準備</h1><ol><li><a href=#server>ローカルサーバーの設定</a></li><li><a href=#git>Gitでバージョン管理</a></li><li><a href=#rsync>ファイル転送様コマンドのエイリアスの作成</a></li></ol></section><section id=server><h2 id=section-1>1.ローカルサーバーの設定</h2><p>この辺は前にも書いたことあるので、省略しますが、ローカルのサーバーでWordpressが動くようにしときます。<br>自分の環境はApache+My<span class=caps>SQL</span>の組み合わせです。メールの設定なんかはスルーしてます。</p></section><section id=git><h2 id=git>2.Gitでバージョン管理</h2><p>とりあえず、コーディング前の準備としてGitで管理するようにします。<br>なんかあったとき用ですね。これもローカルだけの管理なので、<span class=caps>HDD</span>が死んだらアウトです。</p><div class=highlight><pre><code class=bash>git init</code></pre></div><p>次に.gitignoreファイルを作成します。githubにWordpress用の.gitignoreファイルが公開されてるので、それを参考にいらないものを記述します。</p><p><a href=https://github.com/github/gitignore/blob/master/Wordpress.gitignore>github /&nbsp;Wordpress.gitignore</a></p><h3 id=gitignore>.gitignore</h3><div class=highlight><pre><code class=bash><span class=c>#sass</span>
.sass-cache/

<span class=c>#mac</span>
.DS_Store

<span class=c>#win</span>
Thumbs.db

<span class=c>#dreamweaver</span>

_notes/
dwsync.xml

wp-*.php
xmlrpc.php
wp-admin/
wp-includes/
wp-content/plugins/　#追記
wp-content/uploads/
wp-content/blogs.dir/
wp-content/upgrade/*
wp-content/backup-db/*
wp-content/advanced-cache.php
wp-content/wp-cache-config.php
wp-content/cache/*
wp-content/cache/supercache/*
sitemap.xml
sitemap.xml.gz
readme.html
license.txt</code></pre></div><p>ここで、wp-content/plugins/を追記したのは、プラグイン内のファイルでwp-*.phpにマッチしちゃうファイルが結構あって、コンフリクトしちゃうので、めんどくさいからプラグインも無視するようにしました。<br>本番とテストでプラグインは別々になっちゃいますけど、どうせ設定なんかはそれぞれ管理画面からやらなきゃいけないので、まいっかってことで分けるようにしました。</p><p>これを使えば、基本的にはテーマディレクトリ以下のみが無視されないようになります。</p></section><section id=rsync><h2 id=section-2>3.ファイル転送用コマンドのエイリアス作成</h2><p>ファイルの転送もコマンドでできるようにします。<span class=caps>GUI</span>の<span class=caps>FTP</span>クライアントは使いません。<br>いくつか方法はあると思いますが、自分はRsyncコマンドを使います。オプションやら色々設定すると長すぎて毎回入力するのはキツイのでエイリアスを作って簡単に覚えれるようにしときます。</p><p>このサイトはさくらのサーバーで運用してるので、下記の様なコマンドを.bashrcに記述しておきます。</p><div class=highlight><pre><code class=bash><span class=nb>alias </span><span class=nv>synchowtohp</span><span class=o>=</span><span class=s2>&quot;rsync -avvrh --update --exclude-from ~/work/howtohp/.gitignore  --delete -e ssh ~/work/howtohp/ ユーザー名@サーバー名.sakura.ne.jp:~/www/&quot;</span>
</code></pre></div><p><code>~/work/howtohp/</code>の部分は自分のローカル環境のWordpressのルートディレクトリになります。</p><p><code>--exclude-from</code>オプションで、先ほど記述した.gitignoreを利用してるので、.gitignoreに記述してるファイルは無視されます。.gitigrenoreとrsyncでexcludeするファイルの記述ルールは少し違いますが、ここでは、共通して利用できる形で.gitignoreを記述してます。</p><p>これで、synchowtohpと打つだけで同期がとれます。</p><h3 id=rsync>Rsyncコマンドの参考サイト</h3><ul><li><a href=http://www.itmedia.co.jp/enterprise/articles/0804/21/news013.html>はじめてrsyncを使う方が知っておきたい6つのルール</a></li><li><a href=http://x68000.q-e-d.net/~68user/unix/pickup?rsync><span class=caps>UNIX</span>の部屋 コマンド検索:&nbsp;rsync</a></li></ul></section><p>最後の流れまで全部一気に書こうと思ってたけど、長くなりすぎるので、とりあえず下準備編として今回はこのへんで。</p></div></article><div class=pager><a href=# class=pager__prev>&lt;&lt; Prev</a> <a href=# class=pager__next>Next &gt;&gt;</a></div><hr><section class=related-posts><h1>関連記事</h1><ul><li><a rel=bookmark href="/tools/2013/04/24/useful-command-line/">Macユーザーなら覚えといた方がいいTerminalの便利なコマンド</a></li><li><a rel=bookmark href="/tools/2011/08/16/homebrew-install/">Macにパッケージ管理ソフトのhomebrewをインストール</a></li><li><a rel=bookmark href="/css/2011/09/19/compass/">CSS書くならCompass使った方がいいよ。SASS使ってる人なら特に。</a></li><li><a rel=bookmark href="/2013/12/27/sass-bem/">SASSを使ってBEMで記述</a></li><li><a rel=bookmark href="/css/2012/07/20/sass-responsive-web-design/">Sassを使ってレスポンシブウェブデザインにする時に覚えておいた方がいいこと4つ</a></li></ul></section></div><!-- / .main --><div class="footer-container container"><footer class=footer role=contentinfo><div class=social-rss><ul class=social-rss__list><li class=social-rss__item><a href=http://twitter.com/#!/howtohp id=twitter title=Twitter>Twitter</a></li><li class=social-rss__item><a href=http://www.facebook.com/howtohp id=facebook-page title="Facebook Page">Facebook Page</a></li><li class=social-rss__item><a href=http://feeds.feedburner.com/howtohp/ZiSA id=feed title=Feed>feed</a></li></ul></div><p><small class=copy>&#9786;&nbsp;howtohp</small> Powered by <a href="http://jekyllrb.com/">Jekyll</a></p></footer></div><!-- / #footer-container --><script src=/js/scripts.d5d1.js></script></body></html>