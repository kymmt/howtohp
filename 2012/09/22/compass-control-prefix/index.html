<!doctype html><html><head><meta charset=utf-8><title>Compassでベンダープレフィックスなどのブラウザーサポートを制御する方法</title><meta name=viewport content="width=device-width"><meta name=description content=""><!-- Twitter --><meta name=twitter:card content=summary><meta name=twitter:author content=@howtohp><meta name=twitter:title content=Compassでベンダープレフィックスなどのブラウザーサポートを制御する方法><meta name=twitter:description content=""><!-- Facebook --><meta property=og:type content=article><meta property=og:title content=Compassでベンダープレフィックスなどのブラウザーサポートを制御する方法><meta property=og:description content=""><meta property=og:url content="http:howtohp.com/2012/09/22/compass-control-prefix/"><meta property=og:locale content=ja-JP><meta property=article:published_time content="2012-09-22 00:00:00 +0900"><link rel=stylesheet href=/assets/css/main.1d3b.css></head><body itemscope itemtype=http://schema.org/Blog lang=ja><header class="header container" role=banner><div class=header__title><h1><a href="/">howtohp</a></h1></div><nav class=global-nav role=navigation><ul class=global-nav__list><li class=global-nav__item><a class=global-nav__link href="/">HOME</a></li><li class=global-nav__item><a class=global-nav__link href=/archive>Archive</a></li><li class=global-nav__item><a class=global-nav__link href=/about>About</a></li></ul></nav></header><div class="main container--small" role=main><article class="entry h-entry" itemscope itemtype=http://schema.org/BlogPosting><header class=entry__header><h1 class=entry__title itemprop=name>Compassでベンダープレフィックスなどのブラウザーサポートを制御する方法</h1><div class=entry__meta><time class=entry__published itemprop=datePublished datetime="22 Sep 2012"><span class=icon-calendar></span> 22 Sep, 2012</time><div class=entry__tags><span class=icon-tags></span><ul class=entry__tags__list><li class=entry__tags__item itemprop=keywords>Compass</li></ul></div></div><!-- / .entry__meta --></header><div class=entry__content itemprop=articleBody><p>このブログでCompassを紹介して、もう1年以上たちましたが、なかなか普及しないなぁっと思って、色々みていると、ドキュメントや、サンプルコードが乏しいという理由が多いようで、だったらということで、頑張って色々書いていこうと思う。</p><p>とりあえず、今回はいらないベンダープレフィックスとかを出力しない設定をする方法を紹介します。</p><section><h1 id=compass>Compassのクロスブラウザサポート設定</h1><p>Compassでは元々ブラウザーサポートを制御する設定があり、設定ファイル(config.rb)ではなくコンフィグレーション変数で設定します。<br>環境変数って言った方がいいのかな。</p><p>ブラウザーサポートの変数一覧</p><table><thead><tr><th>変数</th><th>初期値</th></tr></thead><tbody><tr><td>$legacy-support-for-ie</td><td>true</td></tr><tr><td>$legacy-support-for-ie6</td><td>$legacy-support-for-ie</td></tr><tr><td>$legacy-support-for-ie7</td><td>$legacy-support-for-ie</td></tr><tr><td>$legacy-support-for-ie8</td><td>$legacy-support-for-ie</td></tr><tr><td>$experimental-support-for-mozilla</td><td>true</td></tr><tr><td>$experimental-support-for-webkit</td><td>true</td></tr><tr><td>$support-for-original-webkit-gradients</td><td>true</td></tr><tr><td>$experimental-support-for-opera</td><td>true</td></tr><tr><td>$experimental-support-for-microsoft</td><td>true</td></tr><tr><td>$experimental-support-for-khtml</td><td>false</td></tr><tr><td>$experimental-support-for-svg</td><td>false</td></tr><tr><td>$legacy-support-for-mozilla</td><td>true</td></tr></tbody></table><p>一つ一つどれに影響するかというのは長くなっちゃうので、省略させてもらいますが、変数名はわかりやすいので、大体の想像はつくかと思います。基本的に<span class=caps>IE8</span>以下はハックで、ベンダー名の物は<span class=caps>CSS3</span>でのベンダープレフィックスの設定という認識でいいかと思います。</p><p>例えばi<span class=caps>OS4</span>/5用のコーディングをする場合、<code>-moz-</code>や<code>-ms-</code>、<code>-o-</code>はいらないので、これらはデフォルトで出力される設定(true)をfalseに変更します。</p><p>自分の場合は、<code>_config.scss</code>のというインポート用にパーシャルのファイルを用意して、そこに記述しています。</p><h3 id=stylescss>style.scss(サンプル)</h3><p>こんな感じの<span class=caps>SCSS</span>をサンプルに説明します。</p><div class=highlight><pre><code class=scss><span class=k>@import</span> <span class=s2>&quot;compass&quot;</span><span class=p>;</span>
<span class=k>@import</span> <span class=s2>&quot;config&quot;</span><span class=p>;</span>

<span class=nc>.sample</span> <span class=p>{</span>
    <span class=k>@include</span><span class=nd> background</span><span class=p>(</span>
            <span class=nf>linear-gradient</span><span class=p>(</span><span class=no>top</span> <span class=no>left</span><span class=o>,</span> <span class=nf>rgba</span><span class=p>(</span><span class=mh>#333</span><span class=o>,.</span><span class=mi>8</span><span class=p>)</span><span class=o>,</span> <span class=nf>rgba</span><span class=p>(</span><span class=mh>#0c0</span><span class=o>,.</span><span class=mi>5</span><span class=p>))</span><span class=o>,</span>
            <span class=nf>radial-gradient</span><span class=p>(</span><span class=mh>#c00</span><span class=o>,</span> <span class=mh>#fff</span> <span class=mi>100</span><span class=kt>px</span><span class=p>)</span>
        <span class=p>)</span>
<span class=p>}</span></code></pre></div><h2 id=ios45>i<span class=caps>OS4</span>/5用の設定</h2><p>例えばi<span class=caps>OS4</span>/5向けの場合は、-webkit-系のプレフィックス以外はいらないので、色々falseにしていきます。</p><h3 id=configscss>_config.scss</h3><div class=highlight><pre><code class=scss><span class=nv>$experimental-support-for-opera</span><span class=o>:</span><span class=n-Pseudo>false</span><span class=p>;</span>
<span class=nv>$experimental-support-for-microsoft</span><span class=o>:</span><span class=n-Pseudo>false</span><span class=p>;</span>
<span class=nv>$experimental-support-for-mozilla</span><span class=o>:</span> <span class=n-Pseudo>false</span><span class=p>;</span></code></pre></div><h3 id=stylecsscss>style.css(出力される<span class=caps>CSS</span>)</h3><div class=highlight><pre><code class=css><span class=nc>.sample</span> <span class=p>{</span>
  <span class=k>background</span><span class=o>:</span> <span class=o>-</span><span class=n>webkit</span><span class=o>-</span><span class=n>gradient</span><span class=p>(</span><span class=n>linear</span><span class=o>,</span> <span class=m>0</span><span class=o>%</span> <span class=m>0</span><span class=o>%,</span> <span class=m>100</span><span class=o>%</span> <span class=m>100</span><span class=o>%,</span> <span class=k>color</span><span class=o>-</span><span class=n>stop</span><span class=p>(</span><span class=m>0</span><span class=o>%,</span> <span class=n>rgba</span><span class=p>(</span><span class=m>51</span><span class=o>,</span> <span class=m>51</span><span class=o>,</span> <span class=m>51</span><span class=o>,</span> <span class=m>0</span><span class=o>.</span><span class=m>8</span><span class=p>))</span><span class=o>,</span> <span class=k>color</span><span class=o>-</span><span class=n>stop</span><span class=p>(</span><span class=m>100</span><span class=o>%,</span> <span class=n>rgba</span><span class=p>(</span><span class=m>0</span><span class=o>,</span> <span class=m>204</span><span class=o>,</span> <span class=m>0</span><span class=o>,</span> <span class=m>0</span><span class=o>.</span><span class=m>5</span><span class=p>)))</span><span class=o>,</span> <span class=o>-</span><span class=n>webkit</span><span class=o>-</span><span class=n>gradient</span><span class=p>(</span><span class=n>radial</span><span class=o>,</span> <span class=m>50</span><span class=o>%</span> <span class=m>50</span><span class=o>%,</span> <span class=m>0</span><span class=o>,</span> <span class=m>50</span><span class=o>%</span> <span class=m>50</span><span class=o>%,</span> <span class=m>100</span><span class=o>,</span> <span class=k>color</span><span class=o>-</span><span class=n>stop</span><span class=p>(</span><span class=m>0</span><span class=o>%,</span> <span class=m>#cccccc</span><span class=p>)</span><span class=o>,</span> <span class=k>color</span><span class=o>-</span><span class=n>stop</span><span class=p>(</span><span class=m>100</span><span class=o>%,</span> <span class=m>#ffffff</span><span class=p>));</span>
  <span class=k>background</span><span class=o>:</span> <span class=o>-</span><span class=n>webkit</span><span class=o>-</span><span class=n>linear</span><span class=o>-</span><span class=n>gradient</span><span class=p>(</span><span class=k>top</span> <span class=k>left</span><span class=o>,</span> <span class=n>rgba</span><span class=p>(</span><span class=m>51</span><span class=o>,</span> <span class=m>51</span><span class=o>,</span> <span class=m>51</span><span class=o>,</span> <span class=m>0</span><span class=o>.</span><span class=m>8</span><span class=p>)</span><span class=o>,</span> <span class=n>rgba</span><span class=p>(</span><span class=m>0</span><span class=o>,</span> <span class=m>204</span><span class=o>,</span> <span class=m>0</span><span class=o>,</span> <span class=m>0</span><span class=o>.</span><span class=m>5</span><span class=p>))</span><span class=o>,</span> <span class=o>-</span><span class=n>webkit</span><span class=o>-</span><span class=n>radial</span><span class=o>-</span><span class=n>gradient</span><span class=p>(</span><span class=m>#cccccc</span><span class=o>,</span> <span class=m>#ffffff</span> <span class=m>100px</span><span class=p>);</span>
  <span class=k>background</span><span class=o>:</span> <span class=n>linear</span><span class=o>-</span><span class=n>gradient</span><span class=p>(</span><span class=k>top</span> <span class=k>left</span><span class=o>,</span> <span class=n>rgba</span><span class=p>(</span><span class=m>51</span><span class=o>,</span> <span class=m>51</span><span class=o>,</span> <span class=m>51</span><span class=o>,</span> <span class=m>0</span><span class=o>.</span><span class=m>8</span><span class=p>)</span><span class=o>,</span> <span class=n>rgba</span><span class=p>(</span><span class=m>0</span><span class=o>,</span> <span class=m>204</span><span class=o>,</span> <span class=m>0</span><span class=o>,</span> <span class=m>0</span><span class=o>.</span><span class=m>5</span><span class=p>))</span><span class=o>,</span> <span class=n>radial</span><span class=o>-</span><span class=n>gradient</span><span class=p>(</span><span class=m>#cccccc</span><span class=o>,</span> <span class=m>#ffffff</span> <span class=m>100px</span><span class=p>);</span>
<span class=p>}</span></code></pre></div><h2 id=ios5>i<span class=caps>OS5</span>のみの場合</h2><p>i<span class=caps>OS5</span>のみの場合は、グラデーションの記法が変わってますので、古い記法を出力する必要はありません。<br>その場合は、_config.scssに古い記法を出力しない設定に変更します。</p><h3 id=configscss-1>_config.scss</h3><div class=highlight><pre><code class=scss><span class=nv>$experimental-support-for-opera</span><span class=o>:</span><span class=n-Pseudo>false</span><span class=p>;</span>
<span class=nv>$experimental-support-for-microsoft</span><span class=o>:</span><span class=n-Pseudo>false</span><span class=p>;</span>
<span class=nv>$experimental-support-for-mozilla</span><span class=o>:</span> <span class=n-Pseudo>false</span><span class=p>;</span>
<span class=nv>$support-for-original-webkit-gradients</span><span class=o>:</span> <span class=n-Pseudo>false</span>   <span class=c1>//これを追記</span></code></pre></div><h3 id=stylecsscss-1>style.css(出力される<span class=caps>CSS</span>)</h3><div class=highlight><pre><code class=css><span class=nc>.sample</span> <span class=p>{</span>
  <span class=k>background</span><span class=o>:</span> <span class=o>-</span><span class=n>webkit</span><span class=o>-</span><span class=n>linear</span><span class=o>-</span><span class=n>gradient</span><span class=p>(</span><span class=k>top</span> <span class=k>left</span><span class=o>,</span> <span class=n>rgba</span><span class=p>(</span><span class=m>51</span><span class=o>,</span> <span class=m>51</span><span class=o>,</span> <span class=m>51</span><span class=o>,</span> <span class=m>0</span><span class=o>.</span><span class=m>8</span><span class=p>)</span><span class=o>,</span> <span class=n>rgba</span><span class=p>(</span><span class=m>0</span><span class=o>,</span> <span class=m>204</span><span class=o>,</span> <span class=m>0</span><span class=o>,</span> <span class=m>0</span><span class=o>.</span><span class=m>5</span><span class=p>))</span><span class=o>,</span> <span class=o>-</span><span class=n>webkit</span><span class=o>-</span><span class=n>radial</span><span class=o>-</span><span class=n>gradient</span><span class=p>(</span><span class=m>#cccccc</span><span class=o>,</span> <span class=m>#ffffff</span> <span class=m>100px</span><span class=p>);</span>
  <span class=k>background</span><span class=o>:</span> <span class=n>linear</span><span class=o>-</span><span class=n>gradient</span><span class=p>(</span><span class=k>top</span> <span class=k>left</span><span class=o>,</span> <span class=n>rgba</span><span class=p>(</span><span class=m>51</span><span class=o>,</span> <span class=m>51</span><span class=o>,</span> <span class=m>51</span><span class=o>,</span> <span class=m>0</span><span class=o>.</span><span class=m>8</span><span class=p>)</span><span class=o>,</span> <span class=n>rgba</span><span class=p>(</span><span class=m>0</span><span class=o>,</span> <span class=m>204</span><span class=o>,</span> <span class=m>0</span><span class=o>,</span> <span class=m>0</span><span class=o>.</span><span class=m>5</span><span class=p>))</span><span class=o>,</span> <span class=n>radial</span><span class=o>-</span><span class=n>gradient</span><span class=p>(</span><span class=m>#cccccc</span><span class=o>,</span> <span class=m>#ffffff</span> <span class=m>100px</span><span class=p>);</span>
<span class=p>}</span></code></pre></div><p>こんな感じで、簡単にプレフィックスの出力をコントロール出来ます。Mixinを作る際のヘルパーも用意されているので、自作でゴリゴリ書くよりは大分楽できるんじゃないでしょうか。</p><h2 id=operaie9svg>Operaと<span class=caps>IE9</span>にグラデーションを<span class=caps>SVG</span>で対応</h2><p>これはグラデーションをOperaと<span class=caps>IE9</span>に対応させるため、<span class=caps>SVG</span>をbase64エンコードしたものを<span class=caps>CSS</span>に書きこんでくれるというCompassの便利機能の一つ。<br>ただ、ファイルサイズが肥大化してしまうので、要注意です。</p><h3 id=configscss-2>_config.scss</h3><div class=highlight><pre><code class=scss><span class=nv>$experimental-support-for-svg</span><span class=o>:</span> <span class=n-Pseudo>true</span><span class=p>;</span></code></pre></div><h3 id=stylecsscss-2>style.css(出力される<span class=caps>CSS</span>)</h3><div class=highlight><pre><code class=css><span class=nc>.sample</span> <span class=p>{</span>
  <span class=c>/* SVGの部分だけ抜粋 */</span>
  <span class=k>background</span><span class=o>:</span> <span class=sx>url(&#39;data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4gPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJncmFkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0icmdiYSg1MSwgNTEsIDUxLCAwLjgpIi8+PHN0b3Agb2Zmc2V0PSIxMDAlIiBzdG9wLWNvbG9yPSJyZ2JhKDAsIDIwNCwgMCwgMC41KSIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JhZCkiIC8+PC9zdmc+IA==&#39;)</span><span class=o>,</span> <span class=sx>url(&#39;data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4gPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHJhZGlhbEdyYWRpZW50IGlkPSJncmFkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY3g9IjUwJSIgY3k9IjUwJSIgcj0iMTAwIj48c3RvcCBvZmZzZXQ9IjAlIiBzdG9wLWNvbG9yPSIjY2NjY2NjIi8+PHN0b3Agb2Zmc2V0PSIxMDAlIiBzdG9wLWNvbG9yPSIjZmZmZmZmIi8+PC9yYWRpYWxHcmFkaWVudD48L2RlZnM+PHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNncmFkKSIgLz48L3N2Zz4g&#39;)</span><span class=p>;</span>
<span class=p>}</span></code></pre></div><p>ちなみにこのサンプルのグラデーションはかなり汚い感じなので、ご注意を。</p><h2 id=section>余談</h2><p>記事を書くついでに、コード表示部分のカラーリングをMonokaiっぽくしてみました。あと、長い行は無理やり改行させるんじゃなく、横スクロールするように変更しました。自分的にはスクロールしたほうが見やすいんじゃないかなと思うんですが、normalize.css使うと、無理やり改行するように書かれてました。</p><p>※<span class=caps>IE9</span>は横スクロールバーがでると変な余白がでちゃったので、改行のままにしています。<span class=caps>IE8</span>以下は無視。<span class=caps>JS</span>でpreの中身をinner<span class=caps>HTML</span>とかで書き換えると改行が消えちゃうっぽいですが今のところ対応しない予定。暇があればやります。</p></section></div><div class=entry__comments><div id=disqus_thread></div><script type=text/javascript>var disqus_shortname = 'howtohp';
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=http://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></article><div class=pager><a href="/2013/04/18/prevent-skype/" class=pager__newer title="Previous Post: Skypeのブラウザ拡張を入れてる人が番号をスタイリングしちゃうのを防ぐ方法">&laquo; Newer</a> <a href="/2012/07/20/sass-responsive-web-design/" class=pager__older title="Older Post: Sassを使ってレスポンシブウェブデザインにする時に覚えておいた方がいいこと4つ">Older &raquo;</a></div><hr><section class="related-posts entries"><h1>関連記事</h1><ul><li class=entries__item><a class=entries__link href="/2011/09/19/compass/" rel=bookmark title=CSS書くならCompass使った方がいいよ。SASS使ってる人なら特に。>CSS書くならCompass使った方がいいよ。SASS使ってる人なら特に。</a> <time class=entries__published published="" itemprop=datePublished datetime="19 Sep 2011">19 Sep, 2011</time></li><li class=entries__item><a class=entries__link href="/2012/07/20/sass-responsive-web-design/" rel=bookmark title=Sassを使ってレスポンシブウェブデザインにする時に覚えておいた方がいいこと4つ>Sassを使ってレスポンシブウェブデザインにする時に覚えておいた方がいいこと4つ</a> <time class=entries__published published="" itemprop=datePublished datetime="20 Jul 2012">20 Jul, 2012</time></li><li class=entries__item><a class=entries__link href="/2011/05/06/css3-text-shadow/" rel=bookmark title=今更ながら、text-shadowを色々試してみる。>今更ながら、text-shadowを色々試してみる。</a> <time class=entries__published published="" itemprop=datePublished datetime="06 May 2011">6 May, 2011</time></li><li class=entries__item><a class=entries__link href="/2008/11/22/min-height/" rel=bookmark title=CSSで最低の高さを実現する。>CSSで最低の高さを実現する。</a> <time class=entries__published published="" itemprop=datePublished datetime="22 Nov 2008">22 Nov, 2008</time></li><li class=entries__item><a class=entries__link href="/2013/12/27/sass-bem/" rel=bookmark title=SASSを使ってBEMで記述>SASSを使ってBEMで記述</a> <time class=entries__published published="" itemprop=datePublished datetime="27 Dec 2013">27 Dec, 2013</time></li></ul></section></div><!-- / .main --><div class="footer-container container"><footer class=footer role=contentinfo><div class=social-rss><ul class=social-rss__list><li class=social-rss__item><a href=http://twitter.com/#!/howtohp id=twitter title=Twitter>Twitter</a></li><li class=social-rss__item><a href=http://www.facebook.com/howtohp id=facebook-page title="Facebook Page">Facebook Page</a></li><li class=social-rss__item><a href=http://feeds.feedburner.com/howtohp/ZiSA id=feed title=Feed>feed</a></li></ul></div><p><small class=copy>&#9786;&nbsp;howtohp</small><br>Powered by <a href="http://jekyllrb.com/">Jekyll</a></p></footer></div><!-- / #footer-container --><script src=//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js></script><script src=/assets/js/scripts.c909.js></script><script type=text/javascript>var disqus_shortname = 'howtohp';
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());</script></body></html>